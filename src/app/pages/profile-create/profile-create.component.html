<div class="min-h-screen bg-gray-50 w-full px-6">
  <!-- Loading Overlay -->
  <app-loading-overlay
    [isVisible]="isSubmitting"
    [title]="isEditMode ? 'Updating Profile' : 'Creating Profile'"
    [message]="
      isEditMode
        ? 'Saving your profile changes...'
        : 'Creating your new profile...'
    "
  ></app-loading-overlay>

  <!-- Header with back arrow and Create/Edit Profile (on gray background) -->
  <div class="flex items-center pt-8 pb-2">
    <button
      (click)="goBack()"
      type="button"
      class="mr-2 text-gray-500 hover:text-gray-700 flex items-center justify-center cursor-pointer"
    >
      <span class="material-icons text-2xl cursor-pointer">arrow_back</span>
    </button>
    <h2 class="text-lg font-semibold text-gray-900">
      {{ isEditMode ? "Edit Profile" : "Create Profile" }}
    </h2>
  </div>

  <form [formGroup]="profileForm" (ngSubmit)="onSubmit()" class="space-y-8">
    <!-- Employee Information Section -->
    <div class="bg-white rounded-xl mt-4 shadow-sm">
      <div class="pt-8 pb-12 px-8">
        <div class="w-full">
          <div
            class="text-base font-medium text-gray-800 border-b border-gray-100 pb-2 mb-6 flex items-center justify-between cursor-pointer"
            (click)="toggleAccordion('employeeInfo')"
          >
            <span>Employee Information</span>
            <button
              type="button"
              class="flex items-center text-gray-400 hover:text-gray-600 transition-colors"
            >
              <svg
                class="w-5 h-5 transform transition-transform"
                [class.rotate-180]="!accordionState.employeeInfo"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                ></path>
              </svg>
            </button>
          </div>
          <div
            *ngIf="accordionState.employeeInfo"
            class="transition-all duration-300"
          >
            <div class="flex flex-row gap-80 w-full">
              <!-- Avatar -->
              <div class="flex flex-col items-center justify-start pt-2">
                <label for="avatarInput" class="relative cursor-pointer">
                  <div
                    class="w-48 h-48 rounded-full bg-gray-100 flex items-center justify-center overflow-hidden"
                  >
                    <img
                      *ngIf="avatarPreview; else defaultAvatar"
                      [src]="avatarPreview"
                      alt="Avatar"
                      class="w-full h-full object-cover rounded-full"
                    />
                    <ng-template #defaultAvatar>
                      <div
                        class="w-full h-full flex items-center justify-center text-gray-400 text-5xl"
                      >
                        <span class="material-icons">person</span>
                      </div>
                    </ng-template>
                  </div>
                  <input
                    id="avatarInput"
                    name="avatar"
                    type="file"
                    accept="image/*"
                    (change)="onAvatarChange($event)"
                    hidden
                  />
                  <div
                    class="absolute bottom-2 right-2 bg-gray-200 rounded-full p-1 flex items-center justify-center"
                  >
                    <span class="material-icons text-base text-gray-600"
                      >photo_camera</span
                    >
                  </div>
                </label>
              </div>
              <!-- Employee Fields -->
              <div class="flex-1 flex flex-col gap-4">
                <!-- Row 1 -->
                <div class="flex flex-row gap-6">
                  <div class="flex flex-col flex-1">
                    <label class="text-sm text-gray-700 mb-1" for="title"
                      >Title *</label
                    >
                    <select
                      formControlName="title"
                      id="title"
                      name="title"
                      autocomplete="honorific-prefix"
                      [class]="
                        'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                        (hasError('title')
                          ? 'border-red-500 focus:ring-red-400'
                          : 'border-gray-300 focus:ring-green-400')
                      "
                    >
                      <option value="">Select</option>
                      <option *ngFor="let title of titles" [value]="title">
                        {{ title }}
                      </option>
                    </select>
                    <div
                      *ngIf="hasError('title')"
                      class="text-red-500 text-xs mt-1"
                    >
                      {{ getErrorMessage("title") }}
                    </div>
                  </div>
                  <div class="flex flex-col flex-1">
                    <label
                      class="text-sm text-gray-700 mb-1"
                      for="legalFirstName"
                      >Legal First Name *</label
                    >
                    <input
                      formControlName="legalFirstName"
                      id="legalFirstName"
                      name="legalFirstName"
                      autocomplete="given-name"
                      placeholder="Enter"
                      type="text"
                      [class]="
                        'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                        (hasError('legalFirstName')
                          ? 'border-red-500 focus:ring-red-400'
                          : 'border-gray-300 focus:ring-green-400')
                      "
                    />
                    <div
                      *ngIf="hasError('legalFirstName')"
                      class="text-red-500 text-xs mt-1"
                    >
                      {{ getErrorMessage("legalFirstName") }}
                    </div>
                  </div>
                </div>
                <!-- Row 2 -->
                <div class="flex flex-row gap-6">
                  <div class="flex flex-col flex-1">
                    <label
                      class="text-sm text-gray-700 mb-1"
                      for="legalMiddleName"
                      >Legal Middle Name *</label
                    >
                    <input
                      formControlName="legalMiddleName"
                      id="legalMiddleName"
                      name="legalMiddleName"
                      autocomplete="additional-name"
                      placeholder="Enter"
                      type="text"
                      [class]="
                        'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                        (hasError('legalMiddleName')
                          ? 'border-red-500 focus:ring-red-400'
                          : 'border-gray-300 focus:ring-green-400')
                      "
                    />
                    <div
                      *ngIf="hasError('legalMiddleName')"
                      class="text-red-500 text-xs mt-1"
                    >
                      {{ getErrorMessage("legalMiddleName") }}
                    </div>
                  </div>
                  <div class="flex flex-col flex-1">
                    <label
                      class="text-sm text-gray-700 mb-1"
                      for="legalLastName"
                      >Legal Last Name *</label
                    >
                    <input
                      formControlName="legalLastName"
                      id="legalLastName"
                      name="legalLastName"
                      autocomplete="family-name"
                      placeholder="Enter"
                      type="text"
                      [class]="
                        'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                        (hasError('legalLastName')
                          ? 'border-red-500 focus:ring-red-400'
                          : 'border-gray-300 focus:ring-green-400')
                      "
                    />
                    <div
                      *ngIf="hasError('legalLastName')"
                      class="text-red-500 text-xs mt-1"
                    >
                      {{ getErrorMessage("legalLastName") }}
                    </div>
                  </div>
                </div>
                <!-- Row 3 -->
                <div class="flex flex-row gap-6">
                  <div class="flex flex-col flex-1">
                    <label
                      class="text-sm text-gray-700 mb-1"
                      for="profferedName"
                      >Proffered Name Of Correspondence *</label
                    >
                    <input
                      formControlName="profferedName"
                      id="profferedName"
                      name="profferedName"
                      autocomplete="name"
                      placeholder="Enter"
                      type="text"
                      [class]="
                        'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                        (hasError('profferedName')
                          ? 'border-red-500 focus:ring-red-400'
                          : 'border-gray-300 focus:ring-green-400')
                      "
                    />
                    <div
                      *ngIf="hasError('profferedName')"
                      class="text-red-500 text-xs mt-1"
                    >
                      {{ getErrorMessage("profferedName") }}
                    </div>
                  </div>
                  <div class="flex flex-col flex-1">
                    <label class="text-sm text-gray-700 mb-1" for="gender"
                      >Gender *</label
                    >
                    <select
                      formControlName="gender"
                      id="gender"
                      name="gender"
                      autocomplete="sex"
                      [class]="
                        'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                        (hasError('gender')
                          ? 'border-red-500 focus:ring-red-400'
                          : 'border-gray-300 focus:ring-green-400')
                      "
                    >
                      <option value="">Select</option>
                      <option *ngFor="let gender of genders" [value]="gender">
                        {{ gender }}
                      </option>
                    </select>
                    <div
                      *ngIf="hasError('gender')"
                      class="text-red-500 text-xs mt-1"
                    >
                      {{ getErrorMessage("gender") }}
                    </div>
                  </div>
                </div>
                <!-- Additional fields moved to other sections -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Contact Information Section (separate white card) -->
    <div class="bg-white rounded-xl mt-6 shadow-sm">
      <div class="pt-8 pb-12 px-8">
        <div class="w-full">
          <div
            class="text-base font-medium text-gray-800 border-b border-gray-100 pb-2 mb-6 flex items-center justify-between cursor-pointer"
            (click)="toggleAccordion('contactInfo')"
          >
            <span>Contact Information</span>
            <button
              type="button"
              class="flex items-center text-gray-400 hover:text-gray-600 transition-colors"
            >
              <svg
                class="w-5 h-5 transform transition-transform"
                [class.rotate-180]="!accordionState.contactInfo"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                ></path>
              </svg>
            </button>
          </div>
          <div
            *ngIf="accordionState.contactInfo"
            class="transition-all duration-300"
          >
            <div class="flex-1 flex flex-col gap-4">
              <!-- Row 1: Home Address, City/Town, State/Province -->
              <div class="flex flex-row gap-6">
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="homeAddress"
                    >Home Address *</label
                  >
                  <input
                    formControlName="homeAddress"
                    id="homeAddress"
                    name="homeAddress"
                    autocomplete="street-address"
                    placeholder="Enter home address"
                    type="text"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('homeAddress')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('homeAddress')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("homeAddress") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="homeCity"
                    >City/Town *</label
                  >
                  <select
                    formControlName="homeCity"
                    id="homeCity"
                    name="homeCity"
                    autocomplete="address-level2"
                    (change)="onCityChange($event)"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('homeCity')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  >
                    <option value="">Select City</option>
                    <option *ngFor="let city of availableCities" [value]="city">
                      {{ city }}
                    </option>
                  </select>
                  <div
                    *ngIf="hasError('homeCity')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("homeCity") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="homeState"
                    >State/Province *</label
                  >
                  <select
                    formControlName="homeState"
                    id="homeState"
                    name="homeState"
                    autocomplete="address-level1"
                    (change)="onStateChange($event)"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('homeState')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  >
                    <option value="">Select State</option>
                    <option
                      *ngFor="let state of availableStates"
                      [value]="state"
                    >
                      {{ state }}
                    </option>
                  </select>
                  <div
                    *ngIf="hasError('homeState')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("homeState") }}
                  </div>
                </div>
              </div>
              <!-- Row 2: Country, Zip Code, Mailing Address -->
              <div class="flex flex-row gap-6">
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="homeCountry"
                    >Country *</label
                  >
                  <select
                    formControlName="homeCountry"
                    id="homeCountry"
                    name="homeCountry"
                    autocomplete="country-name"
                    (change)="onCountryChange($event)"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('homeCountry')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  >
                    <option value="">Select Country</option>
                    <option value="Nigeria">Nigeria</option>
                    <option value="Ghana">Ghana</option>
                    <option value="Kenya">Kenya</option>
                    <option value="South Africa">South Africa</option>
                    <option value="United States">United States</option>
                    <option value="United Kingdom">United Kingdom</option>
                    <option value="Canada">Canada</option>
                  </select>
                  <div
                    *ngIf="hasError('homeCountry')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("homeCountry") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="homeZipCode"
                    >Zip Code *</label
                  >
                  <input
                    formControlName="homeZipCode"
                    id="homeZipCode"
                    name="homeZipCode"
                    autocomplete="postal-code"
                    placeholder="Enter zip code"
                    type="text"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('homeZipCode')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('homeZipCode')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("homeZipCode") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="mailingAddress"
                    >Mailing Address</label
                  >
                  <input
                    formControlName="mailingAddress"
                    id="mailingAddress"
                    name="mailingAddress"
                    autocomplete="street-address"
                    placeholder="Enter mailing address"
                    type="text"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('mailingAddress')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('mailingAddress')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("mailingAddress") }}
                  </div>
                </div>
              </div>
              <!-- Row 3: Primary Phone, Alternate Phone, Email Address -->
              <div class="flex flex-row gap-6">
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="primaryPhone"
                    >Primary Phone *</label
                  >
                  <input
                    formControlName="primaryPhone"
                    id="primaryPhone"
                    name="primaryPhone"
                    autocomplete="tel"
                    placeholder="Enter phone number"
                    type="tel"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('primaryPhone')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('primaryPhone')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("primaryPhone") }}
                  </div>

                  <!-- Primary Phone Type Selection -->
                  <div class="mt-2">
                    <label class="text-xs text-gray-600 mb-1 block"
                      >Phone Type *</label
                    >
                    <div class="flex gap-3">
                      <label class="flex items-center text-sm">
                        <input
                          type="radio"
                          formControlName="primaryPhoneType"
                          value="HOME"
                          class="mr-1"
                        />
                        Home
                      </label>
                      <label class="flex items-center text-sm">
                        <input
                          type="radio"
                          formControlName="primaryPhoneType"
                          value="WORK"
                          class="mr-1"
                        />
                        Work
                      </label>
                      <label class="flex items-center text-sm">
                        <input
                          type="radio"
                          formControlName="primaryPhoneType"
                          value="CELL"
                          class="mr-1"
                        />
                        Cell
                      </label>
                    </div>
                    <div
                      *ngIf="hasError('primaryPhoneType')"
                      class="text-red-500 text-xs mt-1"
                    >
                      {{ getErrorMessage("primaryPhoneType") }}
                    </div>
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="altPhone"
                    >Alternate Phone</label
                  >
                  <input
                    formControlName="altPhone"
                    id="altPhone"
                    name="altPhone"
                    autocomplete="tel"
                    placeholder="Enter phone number"
                    type="tel"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('altPhone')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('altPhone')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("altPhone") }}
                  </div>

                  <!-- Alternate Phone Type Selection -->
                  <div class="mt-2">
                    <label class="text-xs text-gray-600 mb-1 block"
                      >Phone Type</label
                    >
                    <div class="flex gap-3">
                      <label class="flex items-center text-sm">
                        <input
                          type="radio"
                          formControlName="altPhoneType"
                          value="HOME"
                          class="mr-1"
                        />
                        Home
                      </label>
                      <label class="flex items-center text-sm">
                        <input
                          type="radio"
                          formControlName="altPhoneType"
                          value="WORK"
                          class="mr-1"
                        />
                        Work
                      </label>
                      <label class="flex items-center text-sm">
                        <input
                          type="radio"
                          formControlName="altPhoneType"
                          value="CELL"
                          class="mr-1"
                        />
                        Cell
                      </label>
                    </div>
                    <div
                      *ngIf="hasError('altPhoneType')"
                      class="text-red-500 text-xs mt-1"
                    >
                      {{ getErrorMessage("altPhoneType") }}
                    </div>
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="email"
                    >Email Address *</label
                  >
                  <input
                    formControlName="email"
                    id="email"
                    name="email"
                    autocomplete="email"
                    placeholder="Enter email address"
                    type="email"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('email')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('email')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("email") }}
                  </div>
                </div>
              </div>
              <!-- Row 4: Other Information -->
              <div class="flex flex-row gap-6">
                <div class="flex flex-col w-1/3">
                  <label class="text-sm text-gray-700 mb-1" for="other"
                    >Other Information</label
                  >
                  <textarea
                    formControlName="other"
                    id="other"
                    name="other"
                    autocomplete="off"
                    placeholder="Enter additional information"
                    rows="3"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 resize-y ' +
                      (hasError('other')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  ></textarea>
                  <div
                    *ngIf="hasError('other')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("other") }}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Personal Information Section (for worker role only) -->
    <div
      class="bg-white rounded-xl mt-6 shadow-sm"
      *ngIf="currentUserRole === 'worker'"
    >
      <div class="pt-8 pb-12 px-8">
        <div class="w-full">
          <div
            class="text-base font-medium text-gray-800 border-b border-gray-100 pb-2 mb-6 flex items-center justify-between cursor-pointer"
            (click)="toggleAccordion('personalInfo')"
          >
            <span>Personal Information</span>
            <button
              type="button"
              class="flex items-center text-gray-400 hover:text-gray-600 transition-colors"
            >
              <svg
                class="w-5 h-5 transform transition-transform"
                [class.rotate-180]="!accordionState.personalInfo"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                ></path>
              </svg>
            </button>
          </div>
          <div
            *ngIf="accordionState.personalInfo"
            class="transition-all duration-300"
          >
            <div class="flex-1 flex flex-col gap-4">
              <!-- Row 1: Worker-specific fields -->
              <div class="flex flex-row gap-6">
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="maritalStatus"
                    >Marital Status *</label
                  >
                  <select
                    formControlName="maritalStatus"
                    id="maritalStatus"
                    name="maritalStatus"
                    autocomplete="off"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('maritalStatus')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  >
                    <option value="">Select</option>
                    <option
                      *ngFor="let status of maritalStatuses"
                      [value]="status"
                    >
                      {{ status }}
                    </option>
                  </select>
                  <div
                    *ngIf="hasError('maritalStatus')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("maritalStatus") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="everDivorced"
                    >Ever Divorced *</label
                  >
                  <select
                    formControlName="everDivorced"
                    id="everDivorced"
                    name="everDivorced"
                    autocomplete="off"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('everDivorced')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  >
                    <option value="">Select</option>
                    <option
                      *ngFor="let option of everDivorcedOptions"
                      [value]="option"
                    >
                      {{ option }}
                    </option>
                  </select>
                  <div
                    *ngIf="hasError('everDivorced')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("everDivorced") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="dateOfBirth"
                    >Date Of Birth *</label
                  >
                  <input
                    formControlName="dateOfBirth"
                    id="dateOfBirth"
                    name="dateOfBirth"
                    autocomplete="bday"
                    placeholder="MM-DD-YYYY"
                    type="date"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('dateOfBirth')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('dateOfBirth')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("dateOfBirth") }}
                  </div>
                </div>
              </div>
              <!-- Row 2: National ID -->
              <div class="flex flex-row gap-6">
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="nationIdNumber"
                    >Nation Identification Number *</label
                  >
                  <input
                    formControlName="nationIdNumber"
                    id="nationIdNumber"
                    name="nationIdNumber"
                    autocomplete="off"
                    placeholder="Enter your national ID number"
                    type="text"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('nationIdNumber')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('nationIdNumber')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("nationIdNumber") }}
                  </div>
                </div>
                <div class="flex-1"></div>
                <div class="flex-1"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Family Information Section (for non-worker roles) -->
    <div
      class="bg-white rounded-xl mt-6 shadow-sm"
      *ngIf="currentUserRole !== 'worker'"
    >
      <div class="pt-8 pb-12 px-8">
        <div class="w-full">
          <div
            class="text-base font-medium text-gray-800 border-b border-gray-100 pb-2 mb-6 flex items-center justify-between cursor-pointer"
            (click)="toggleAccordion('familyInfo')"
          >
            <span>Family Information</span>
            <button
              type="button"
              class="flex items-center text-gray-400 hover:text-gray-600 transition-colors"
            >
              <svg
                class="w-5 h-5 transform transition-transform"
                [class.rotate-180]="!accordionState.familyInfo"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                ></path>
              </svg>
            </button>
          </div>
          <div
            *ngIf="accordionState.familyInfo"
            class="transition-all duration-300"
          >
            <div class="flex-1 flex flex-col gap-4">
              <!-- Row 1: Personal Info -->
              <div class="flex flex-row gap-6">
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="maritalStatus"
                    >Marital Status *</label
                  >
                  <select
                    formControlName="maritalStatus"
                    id="maritalStatus"
                    name="maritalStatus"
                    autocomplete="off"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('maritalStatus')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  >
                    <option value="">Select</option>
                    <option
                      *ngFor="let status of maritalStatuses"
                      [value]="status"
                    >
                      {{ status }}
                    </option>
                  </select>
                  <div
                    *ngIf="hasError('maritalStatus')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("maritalStatus") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="everDivorced"
                    >Ever Divorced *</label
                  >
                  <select
                    formControlName="everDivorced"
                    id="everDivorced"
                    name="everDivorced"
                    autocomplete="off"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('everDivorced')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  >
                    <option value="">Select</option>
                    <option
                      *ngFor="let option of everDivorcedOptions"
                      [value]="option"
                    >
                      {{ option }}
                    </option>
                  </select>
                  <div
                    *ngIf="hasError('everDivorced')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("everDivorced") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="dateOfBirth"
                    >Date Of Birth *</label
                  >
                  <input
                    formControlName="dateOfBirth"
                    id="dateOfBirth"
                    name="dateOfBirth"
                    autocomplete="bday"
                    placeholder="MM-DD-YYYY"
                    type="date"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('dateOfBirth')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('dateOfBirth')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("dateOfBirth") }}
                  </div>
                </div>
              </div>
              <!-- Row 2: Spouse Information -->
              <div class="flex flex-row gap-6">
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="weddingDate"
                    >Wedding Date</label
                  >
                  <input
                    formControlName="weddingDate"
                    id="weddingDate"
                    name="weddingDate"
                    autocomplete="off"
                    placeholder="MM-DD-YYYY"
                    type="date"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('weddingDate')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('weddingDate')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("weddingDate") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="spouseFirstName"
                    >Spouse's First Name</label
                  >
                  <input
                    formControlName="spouseFirstName"
                    id="spouseFirstName"
                    name="spouseFirstName"
                    autocomplete="off"
                    placeholder="Enter spouse's first name"
                    type="text"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('spouseFirstName')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('spouseFirstName')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("spouseFirstName") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="spouseMaidenName"
                    >Spouse's Maiden Name</label
                  >
                  <input
                    formControlName="spouseMaidenName"
                    id="spouseMaidenName"
                    name="spouseMaidenName"
                    autocomplete="off"
                    placeholder="Enter spouse's maiden name"
                    type="text"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('spouseMaidenName')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('spouseMaidenName')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("spouseMaidenName") }}
                  </div>
                </div>
              </div>
              <!-- Row 3: Spouse Date of Birth -->
              <div class="flex flex-row gap-6">
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="spouseDob"
                    >Spouse's Date of Birth</label
                  >
                  <input
                    formControlName="spouseDob"
                    id="spouseDob"
                    name="spouseDob"
                    autocomplete="off"
                    placeholder="MM-DD-YYYY"
                    type="date"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('spouseDob')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('spouseDob')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("spouseDob") }}
                  </div>
                </div>
                <div class="flex-1"></div>
                <div class="flex-1"></div>
              </div>
              <!-- Children Dynamic Section -->
              <div formArrayName="children">
                <div class="flex items-center justify-between mb-4">
                  <span class="text-sm font-medium text-gray-700">Child</span>
                  <button
                    type="button"
                    (click)="addChild()"
                    class="flex items-center gap-1 text-green-600 hover:text-green-700 transition-colors"
                  >
                    <svg
                      class="w-4 h-4"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 4v16m8-8H4"
                      ></path>
                    </svg>
                    <span class="text-sm">Add Child</span>
                  </button>
                </div>
                <div
                  *ngFor="let child of children.controls; let i = index"
                  [formGroupName]="i"
                  class="mb-4"
                >
                  <div class="flex items-center justify-between mb-3">
                    <span class="text-sm font-medium text-gray-700">
                      Child {{ i + 1 }}
                    </span>
                    <button
                      type="button"
                      (click)="removeChild(i)"
                      class="text-red-600 hover:text-red-700 transition-colors"
                    >
                      <svg
                        class="w-4 h-4"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                        ></path>
                      </svg>
                    </button>
                  </div>
                  <div class="flex flex-row gap-4">
                    <div class="flex flex-col flex-1">
                      <label class="text-xs text-gray-600 mb-1"
                        >Child Name *</label
                      >
                      <input
                        formControlName="childName"
                        type="text"
                        placeholder="Enter child's name"
                        [class]="
                          'border rounded-md px-3 py-2 bg-white focus:outline-none focus:ring-2 text-sm ' +
                          (hasFormArrayError('children', i, 'childName')
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      />
                      <div
                        *ngIf="hasFormArrayError('children', i, 'childName')"
                        class="text-red-500 text-xs mt-1"
                      >
                        {{
                          getFormArrayErrorMessage("children", i, "childName")
                        }}
                      </div>
                    </div>
                    <div class="flex flex-col flex-1">
                      <label class="text-xs text-gray-600 mb-1"
                        >Child Date of Birth *</label
                      >
                      <input
                        formControlName="childDob"
                        type="date"
                        placeholder="MM-DD-YYYY"
                        [class]="
                          'border rounded-md px-3 py-2 bg-white focus:outline-none focus:ring-2 text-sm ' +
                          (hasFormArrayError('children', i, 'childDob')
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      />
                      <div
                        *ngIf="hasFormArrayError('children', i, 'childDob')"
                        class="text-red-500 text-xs mt-1"
                      >
                        {{
                          getFormArrayErrorMessage("children", i, "childDob")
                        }}
                      </div>
                    </div>
                    <div class="flex flex-col flex-1">
                      <label class="text-xs text-gray-600 mb-1"
                        >Child Gender *</label
                      >
                      <select
                        formControlName="childGender"
                        [class]="
                          'border rounded-md px-3 py-2 bg-white focus:outline-none focus:ring-2 text-sm ' +
                          (hasFormArrayError('children', i, 'childGender')
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      >
                        <option value="">Select</option>
                        <option
                          *ngFor="let gender of genderOptionsChildren"
                          [value]="gender"
                        >
                          {{ gender }}
                        </option>
                      </select>
                      <div
                        *ngIf="hasFormArrayError('children', i, 'childGender')"
                        class="text-red-500 text-xs mt-1"
                      >
                        {{
                          getFormArrayErrorMessage("children", i, "childGender")
                        }}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Spiritual History Section -->
    <div class="bg-white rounded-xl mt-6 shadow-sm">
      <div class="pt-8 pb-12 px-8">
        <div class="w-full">
          <div
            class="text-base font-medium text-gray-800 border-b border-gray-100 pb-2 mb-6 flex items-center justify-between cursor-pointer"
            (click)="toggleAccordion('spiritualHistory')"
          >
            <span>Spiritual History</span>
            <button
              type="button"
              class="flex items-center text-gray-400 hover:text-gray-600 transition-colors"
            >
              <svg
                class="w-5 h-5 transform transition-transform"
                [class.rotate-180]="!accordionState.spiritualHistory"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                ></path>
              </svg>
            </button>
          </div>
          <div
            *ngIf="accordionState.spiritualHistory"
            class="transition-all duration-300"
          >
            <div class="flex-1 flex flex-col gap-4">
              <!-- Row 1 -->
              <div class="flex flex-row gap-6">
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="yearSaved"
                    >Year Saved *</label
                  >
                  <input
                    formControlName="yearSaved"
                    id="yearSaved"
                    name="yearSaved"
                    autocomplete="off"
                    placeholder="MM-DD-YYYY"
                    type="date"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('yearSaved')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('yearSaved')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("yearSaved") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label class="text-sm text-gray-700 mb-1" for="sanctified"
                    >Sanctified *</label
                  >
                  <select
                    formControlName="sanctified"
                    id="sanctified"
                    name="sanctified"
                    autocomplete="off"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('sanctified')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  >
                    <option value="">Select</option>
                    <option
                      *ngFor="let option of sanctifiedOptions"
                      [value]="option"
                    >
                      {{ option }}
                    </option>
                  </select>
                  <div
                    *ngIf="hasError('sanctified')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("sanctified") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="baptizedWithHolySpirit"
                    >Baptized with Holy Spirit *</label
                  >
                  <select
                    formControlName="baptizedWithHolySpirit"
                    id="baptizedWithHolySpirit"
                    name="baptizedWithHolySpirit"
                    autocomplete="off"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('baptizedWithHolySpirit')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  >
                    <option value="">Select</option>
                    <option
                      *ngFor="let option of baptizedOptions"
                      [value]="option"
                    >
                      {{ option }}
                    </option>
                  </select>
                  <div
                    *ngIf="hasError('baptizedWithHolySpirit')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("baptizedWithHolySpirit") }}
                  </div>
                </div>
              </div>
              <!-- Row 2 -->
              <div class="flex flex-row gap-6">
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="yearOfWaterBaptism"
                    >Year Water Baptised *</label
                  >
                  <input
                    formControlName="yearOfWaterBaptism"
                    id="yearOfWaterBaptism"
                    name="yearOfWaterBaptism"
                    autocomplete="off"
                    placeholder="MM-DD-YYYY"
                    type="date"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('yearOfWaterBaptism')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('yearOfWaterBaptism')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("yearOfWaterBaptism") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="firstYearInApostolicChurch"
                    >First Year in Apostolic Church *</label
                  >
                  <input
                    formControlName="firstYearInApostolicChurch"
                    id="firstYearInApostolicChurch"
                    name="firstYearInApostolicChurch"
                    autocomplete="off"
                    placeholder="MM-DD-YYYY"
                    type="date"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('firstYearInApostolicChurch')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('firstYearInApostolicChurch')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("firstYearInApostolicChurch") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="isFaithfulInTithing"
                    >Are you faithful in tithing *</label
                  >
                  <select
                    formControlName="isFaithfulInTithing"
                    id="isFaithfulInTithing"
                    name="isFaithfulInTithing"
                    autocomplete="off"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('isFaithfulInTithing')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  >
                    <option value="">Select</option>
                    <option
                      *ngFor="let option of tithingOptions"
                      [value]="option"
                    >
                      {{ option }}
                    </option>
                  </select>
                  <div
                    *ngIf="hasError('isFaithfulInTithing')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("isFaithfulInTithing") }}
                  </div>
                </div>
              </div>

              <!-- Worker-Only Service Information Fields -->
              <div *ngIf="currentUserRole === 'worker'" class="mt-8">
                <div class="border-t border-gray-200 pt-6">
                  <h4 class="text-sm font-medium text-gray-700 mb-4">
                    Service Information
                  </h4>

                  <!-- Row 1: Area of Service, Ever Served, Date -->
                  <div class="flex flex-row gap-6 mb-4">
                    <div class="flex flex-col flex-1">
                      <label
                        class="text-sm text-gray-700 mb-1"
                        for="areaOfService"
                        >Area of Service *</label
                      >
                      <input
                        formControlName="areaOfService"
                        id="areaOfService"
                        name="areaOfService"
                        autocomplete="off"
                        placeholder="Enter area of service"
                        type="text"
                        [class]="
                          'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                          (hasError('areaOfService')
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      />
                      <div
                        *ngIf="hasError('areaOfService')"
                        class="text-red-500 text-xs mt-1"
                      >
                        {{ getErrorMessage("areaOfService") }}
                      </div>
                    </div>
                    <div class="flex flex-col flex-1">
                      <label
                        class="text-sm text-gray-700 mb-1"
                        for="everServedInApostolicChurch"
                        >Ever served in Apostolic church? *</label
                      >
                      <select
                        formControlName="everServedInApostolicChurch"
                        id="everServedInApostolicChurch"
                        name="everServedInApostolicChurch"
                        autocomplete="off"
                        [class]="
                          'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                          (hasError('everServedInApostolicChurch')
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      >
                        <option value="">Select</option>
                        <option
                          *ngFor="let option of sanctifiedOptions"
                          [value]="option"
                        >
                          {{ option }}
                        </option>
                      </select>
                      <div
                        *ngIf="hasError('everServedInApostolicChurch')"
                        class="text-red-500 text-xs mt-1"
                      >
                        {{ getErrorMessage("everServedInApostolicChurch") }}
                      </div>
                    </div>
                    <div class="flex flex-col flex-1">
                      <label
                        class="text-sm text-gray-700 mb-1"
                        for="serviceDate"
                        >Date *</label
                      >
                      <input
                        formControlName="serviceDate"
                        id="serviceDate"
                        name="serviceDate"
                        autocomplete="off"
                        placeholder="MM-DD-YYYY"
                        type="date"
                        [class]="
                          'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                          (hasError('serviceDate')
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      />
                      <div
                        *ngIf="hasError('serviceDate')"
                        class="text-red-500 text-xs mt-1"
                      >
                        {{ getErrorMessage("serviceDate") }}
                      </div>
                    </div>
                  </div>

                  <!-- Row 2: Location, City/Town, State/Province -->
                  <div class="flex flex-row gap-6 mb-4">
                    <div class="flex flex-col flex-1">
                      <label
                        class="text-sm text-gray-700 mb-1"
                        for="serviceLocation"
                        >Location *</label
                      >
                      <input
                        formControlName="serviceLocation"
                        id="serviceLocation"
                        name="serviceLocation"
                        autocomplete="off"
                        placeholder="Enter location"
                        type="text"
                        [class]="
                          'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                          (hasError('serviceLocation')
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      />
                      <div
                        *ngIf="hasError('serviceLocation')"
                        class="text-red-500 text-xs mt-1"
                      >
                        {{ getErrorMessage("serviceLocation") }}
                      </div>
                    </div>
                    <div class="flex flex-col flex-1">
                      <label
                        class="text-sm text-gray-700 mb-1"
                        for="serviceCity"
                        >City/Town *</label
                      >
                      <input
                        formControlName="serviceCity"
                        id="serviceCity"
                        name="serviceCity"
                        autocomplete="off"
                        placeholder="Enter city/town"
                        type="text"
                        [class]="
                          'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                          (hasError('serviceCity')
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      />
                      <div
                        *ngIf="hasError('serviceCity')"
                        class="text-red-500 text-xs mt-1"
                      >
                        {{ getErrorMessage("serviceCity") }}
                      </div>
                    </div>
                    <div class="flex flex-col flex-1">
                      <label
                        class="text-sm text-gray-700 mb-1"
                        for="serviceState"
                        >State/Province *</label
                      >
                      <input
                        formControlName="serviceState"
                        id="serviceState"
                        name="serviceState"
                        autocomplete="off"
                        placeholder="Enter state/province"
                        type="text"
                        [class]="
                          'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                          (hasError('serviceState')
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      />
                      <div
                        *ngIf="hasError('serviceState')"
                        class="text-red-500 text-xs mt-1"
                      >
                        {{ getErrorMessage("serviceState") }}
                      </div>
                    </div>
                  </div>

                  <!-- Row 3: Country, Pastor, Ordained -->
                  <div class="flex flex-row gap-6 mb-4">
                    <div class="flex flex-col flex-1">
                      <label
                        class="text-sm text-gray-700 mb-1"
                        for="serviceCountry"
                        >Country *</label
                      >
                      <input
                        formControlName="serviceCountry"
                        id="serviceCountry"
                        name="serviceCountry"
                        autocomplete="off"
                        placeholder="Enter country"
                        type="text"
                        [class]="
                          'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                          (hasError('serviceCountry')
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      />
                      <div
                        *ngIf="hasError('serviceCountry')"
                        class="text-red-500 text-xs mt-1"
                      >
                        {{ getErrorMessage("serviceCountry") }}
                      </div>
                    </div>
                    <div class="flex flex-col flex-1">
                      <label
                        class="text-sm text-gray-700 mb-1"
                        for="servicePastor"
                        >Pastor *</label
                      >
                      <input
                        formControlName="servicePastor"
                        id="servicePastor"
                        name="servicePastor"
                        autocomplete="off"
                        placeholder="Enter pastor name"
                        type="text"
                        [class]="
                          'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                          (hasError('servicePastor')
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      />
                      <div
                        *ngIf="hasError('servicePastor')"
                        class="text-red-500 text-xs mt-1"
                      >
                        {{ getErrorMessage("servicePastor") }}
                      </div>
                    </div>
                    <div class="flex flex-col flex-1">
                      <label class="text-sm text-gray-700 mb-1" for="ordained"
                        >Ordained *</label
                      >
                      <select
                        formControlName="ordained"
                        id="ordained"
                        name="ordained"
                        autocomplete="off"
                        [class]="
                          'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                          (hasError('ordained')
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      >
                        <option value="">Select</option>
                        <option
                          *ngFor="let option of sanctifiedOptions"
                          [value]="option"
                        >
                          {{ option }}
                        </option>
                      </select>
                      <div
                        *ngIf="hasError('ordained')"
                        class="text-red-500 text-xs mt-1"
                      >
                        {{ getErrorMessage("ordained") }}
                      </div>
                    </div>
                  </div>

                  <!-- Row 4: Ordained Date -->
                  <div class="flex flex-row gap-6 mb-4">
                    <div class="flex flex-col flex-1">
                      <label
                        class="text-sm text-gray-700 mb-1"
                        for="ordainedDate"
                        >Ordained Date</label
                      >
                      <input
                        formControlName="ordainedDate"
                        id="ordainedDate"
                        name="ordainedDate"
                        autocomplete="off"
                        placeholder="MM-DD-YYYY"
                        type="date"
                        [class]="
                          'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                          (hasError('ordainedDate')
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      />
                      <div
                        *ngIf="hasError('ordainedDate')"
                        class="text-red-500 text-xs mt-1"
                      >
                        {{ getErrorMessage("ordainedDate") }}
                      </div>
                    </div>
                    <div class="flex-1"></div>
                    <div class="flex-1"></div>
                  </div>

                  <!-- Previous Positions Dynamic Section -->
                  <div formArrayName="previousPositions">
                    <div class="flex items-center justify-between mb-4">
                      <span class="text-sm font-medium text-gray-700"
                        >Previous Positions</span
                      >
                      <button
                        type="button"
                        (click)="addPreviousPosition()"
                        class="flex items-center gap-1 text-green-600 hover:text-green-700 transition-colors"
                      >
                        <svg
                          class="w-4 h-4"
                          fill="none"
                          stroke="currentColor"
                          viewBox="0 0 24 24"
                        >
                          <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M12 4v16m8-8H4"
                          ></path>
                        </svg>
                        <span class="text-sm">Add Position</span>
                      </button>
                    </div>
                    <div
                      *ngFor="
                        let position of previousPositions.controls;
                        let i = index
                      "
                      [formGroupName]="i"
                      class="mb-4"
                    >
                      <div class="flex items-center justify-between mb-3">
                        <span class="text-sm font-medium text-gray-700">
                          Position {{ i + 1 }}
                        </span>
                        <button
                          type="button"
                          (click)="removePreviousPosition(i)"
                          class="text-red-600 hover:text-red-700 transition-colors"
                        >
                          <svg
                            class="w-4 h-4"
                            fill="none"
                            stroke="currentColor"
                            viewBox="0 0 24 24"
                          >
                            <path
                              stroke-linecap="round"
                              stroke-linejoin="round"
                              stroke-width="2"
                              d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                            ></path>
                          </svg>
                        </button>
                      </div>
                      <div class="flex flex-row gap-4">
                        <div class="flex flex-col flex-1">
                          <label class="text-xs text-gray-600 mb-1"
                            >Position Title *</label
                          >
                          <input
                            formControlName="previousPositionTitle"
                            type="text"
                            placeholder="Enter position title"
                            [class]="
                              'border rounded-md px-3 py-2 bg-white focus:outline-none focus:ring-2 text-sm ' +
                              (hasFormArrayError(
                                'previousPositions',
                                i,
                                'previousPositionTitle'
                              )
                                ? 'border-red-500 focus:ring-red-400'
                                : 'border-gray-300 focus:ring-green-400')
                            "
                          />
                          <div
                            *ngIf="
                              hasFormArrayError(
                                'previousPositions',
                                i,
                                'previousPositionTitle'
                              )
                            "
                            class="text-red-500 text-xs mt-1"
                          >
                            {{
                              getFormArrayErrorMessage(
                                "previousPositions",
                                i,
                                "previousPositionTitle"
                              )
                            }}
                          </div>
                        </div>
                        <div class="flex flex-col flex-1">
                          <label class="text-xs text-gray-600 mb-1"
                            >Position *</label
                          >
                          <input
                            formControlName="previousPosition"
                            type="text"
                            placeholder="Enter position"
                            [class]="
                              'border rounded-md px-3 py-2 bg-white focus:outline-none focus:ring-2 text-sm ' +
                              (hasFormArrayError(
                                'previousPositions',
                                i,
                                'previousPosition'
                              )
                                ? 'border-red-500 focus:ring-red-400'
                                : 'border-gray-300 focus:ring-green-400')
                            "
                          />
                          <div
                            *ngIf="
                              hasFormArrayError(
                                'previousPositions',
                                i,
                                'previousPosition'
                              )
                            "
                            class="text-red-500 text-xs mt-1"
                          >
                            {{
                              getFormArrayErrorMessage(
                                "previousPositions",
                                i,
                                "previousPosition"
                              )
                            }}
                          </div>
                        </div>
                        <div class="flex flex-col flex-1">
                          <label class="text-xs text-gray-600 mb-1"
                            >Date *</label
                          >
                          <input
                            formControlName="previousPositionDate"
                            type="date"
                            placeholder="MM-DD-YYYY"
                            [class]="
                              'border rounded-md px-3 py-2 bg-white focus:outline-none focus:ring-2 text-sm ' +
                              (hasFormArrayError(
                                'previousPositions',
                                i,
                                'previousPositionDate'
                              )
                                ? 'border-red-500 focus:ring-red-400'
                                : 'border-gray-300 focus:ring-green-400')
                            "
                          />
                          <div
                            *ngIf="
                              hasFormArrayError(
                                'previousPositions',
                                i,
                                'previousPositionDate'
                              )
                            "
                            class="text-red-500 text-xs mt-1"
                          >
                            {{
                              getFormArrayErrorMessage(
                                "previousPositions",
                                i,
                                "previousPositionDate"
                              )
                            }}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Area Of Service Section (for non-worker roles only) -->
    <div
      class="bg-white rounded-xl mt-6 shadow-sm"
      *ngIf="currentUserRole !== 'worker'"
    >
      <div class="pt-8 pb-12 px-8">
        <div class="w-full">
          <div
            class="text-base font-medium text-gray-800 border-b border-gray-100 pb-2 mb-6 flex items-center justify-between cursor-pointer"
            (click)="toggleAccordion('areaOfService')"
          >
            <span>Area Of Service</span>
            <button
              type="button"
              class="flex items-center text-gray-400 hover:text-gray-600 transition-colors"
            >
              <svg
                class="w-5 h-5 transform transition-transform"
                [class.rotate-180]="!accordionState.areaOfService"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                ></path>
              </svg>
            </button>
          </div>
          <div
            *ngIf="accordionState.areaOfService"
            class="transition-all duration-300"
          >
            <div class="flex-1 flex flex-col gap-4">
              <!-- Previous Church Positions - Multi-select with tags -->
              <div class="flex flex-col w-full">
                <label class="text-sm text-gray-700 mb-1"
                  >Previous Church Position</label
                >
                <div class="relative">
                  <div
                    class="border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 border-gray-300 focus:ring-green-400 min-h-[42px] flex flex-wrap gap-2 cursor-pointer"
                    (click)="togglePositionDropdown()"
                  >
                    <!-- Selected positions as tags -->
                    <div
                      *ngFor="let position of selectedChurchPositions"
                      class="bg-green-100 text-green-800 px-2 py-1 rounded-md text-sm flex items-center gap-1"
                    >
                      <span>{{ position }}</span>
                      <button
                        type="button"
                        (click)="
                          removeChurchPosition(position);
                          $event.stopPropagation()
                        "
                        class="text-green-600 hover:text-green-800 ml-1"
                      >
                        <svg
                          class="w-3 h-3"
                          fill="currentColor"
                          viewBox="0 0 20 20"
                        >
                          <path
                            fill-rule="evenodd"
                            d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                            clip-rule="evenodd"
                          ></path>
                        </svg>
                      </button>
                    </div>
                    <!-- Placeholder text when no positions selected -->
                    <span
                      *ngIf="selectedChurchPositions.length === 0"
                      class="text-gray-500 py-1"
                      >Select church positions...</span
                    >
                  </div>
                  <!-- Dropdown -->
                  <div
                    *ngIf="showPositionDropdown"
                    class="absolute top-full left-0 right-0 bg-white border border-gray-300 rounded-md shadow-lg z-10 max-h-48 overflow-y-auto"
                  >
                    <div
                      *ngFor="let position of getAvailablePositions()"
                      class="px-3 py-2 hover:bg-gray-100 cursor-pointer text-sm"
                      (click)="selectChurchPosition(position)"
                    >
                      {{ position }}
                    </div>
                    <div
                      *ngIf="getAvailablePositions().length === 0"
                      class="px-3 py-2 text-gray-500 text-sm"
                    >
                      All positions selected
                    </div>
                  </div>
                </div>
              </div>

              <!-- Row 1: Date of First Sermon, Location of First Sermon, City/Town -->
              <div class="flex flex-row gap-6">
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="dateOfFirstSermon"
                    >Date of First Sermon</label
                  >
                  <input
                    formControlName="dateOfFirstSermon"
                    id="dateOfFirstSermon"
                    name="dateOfFirstSermon"
                    autocomplete="off"
                    placeholder="MM-DD-YYYY"
                    type="date"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('dateOfFirstSermon')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('dateOfFirstSermon')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("dateOfFirstSermon") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="firstSermonLocation"
                    >Location of First Sermon</label
                  >
                  <input
                    formControlName="firstSermonLocation"
                    id="firstSermonLocation"
                    name="firstSermonLocation"
                    autocomplete="off"
                    placeholder="Enter location"
                    type="text"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('firstSermonLocation')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('firstSermonLocation')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("firstSermonLocation") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="firstSermonCityArea"
                    >City/Town</label
                  >
                  <input
                    formControlName="firstSermonCityArea"
                    id="firstSermonCityArea"
                    name="firstSermonCityArea"
                    autocomplete="off"
                    placeholder="Enter city/town"
                    type="text"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('firstSermonCityArea')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('firstSermonCityArea')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("firstSermonCityArea") }}
                  </div>
                </div>
              </div>

              <!-- Row 2: State/Province, Country, Pastor -->
              <div class="flex flex-row gap-6">
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="firstSermonStateArea"
                    >State/Province</label
                  >
                  <input
                    formControlName="firstSermonStateArea"
                    id="firstSermonStateArea"
                    name="firstSermonStateArea"
                    autocomplete="off"
                    placeholder="Enter state/province"
                    type="text"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('firstSermonStateArea')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('firstSermonStateArea')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("firstSermonStateArea") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="firstSermonCountryArea"
                    >Country</label
                  >
                  <input
                    formControlName="firstSermonCountryArea"
                    id="firstSermonCountryArea"
                    name="firstSermonCountryArea"
                    autocomplete="off"
                    placeholder="Enter country"
                    type="text"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('firstSermonCountryArea')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('firstSermonCountryArea')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("firstSermonCountryArea") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="firstSermonPastorArea"
                    >Pastor</label
                  >
                  <input
                    formControlName="firstSermonPastorArea"
                    id="firstSermonPastorArea"
                    name="firstSermonPastorArea"
                    autocomplete="off"
                    placeholder="Enter pastor name"
                    type="text"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('firstSermonPastorArea')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('firstSermonPastorArea')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("firstSermonPastorArea") }}
                  </div>
                </div>
              </div>

              <!-- Row 3: Current Status, Name of Recent Credentials, Credential Number -->
              <div class="flex flex-row gap-6">
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="currentStatusArea"
                    >Current Status</label
                  >
                  <input
                    formControlName="currentStatusArea"
                    id="currentStatusArea"
                    name="currentStatusArea"
                    autocomplete="off"
                    placeholder="Enter current status"
                    type="text"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('currentStatusArea')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('currentStatusArea')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("currentStatusArea") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="recentCredentialsNameArea"
                    >Name of Recent Credentials</label
                  >
                  <input
                    formControlName="recentCredentialsNameArea"
                    id="recentCredentialsNameArea"
                    name="recentCredentialsNameArea"
                    autocomplete="off"
                    placeholder="Enter credential name"
                    type="text"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('recentCredentialsNameArea')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('recentCredentialsNameArea')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("recentCredentialsNameArea") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="credentialNumberArea"
                    >Credential Number</label
                  >
                  <input
                    formControlName="credentialNumberArea"
                    id="credentialNumberArea"
                    name="credentialNumberArea"
                    autocomplete="off"
                    placeholder="Enter credential number"
                    type="text"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('credentialNumberArea')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('credentialNumberArea')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("credentialNumberArea") }}
                  </div>
                </div>
              </div>

              <!-- Row 4: Date Issued, Expiration Date, Current Church Location -->
              <div class="flex flex-row gap-6">
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="credentialDateIssuedArea"
                    >Date Issued</label
                  >
                  <input
                    formControlName="credentialDateIssuedArea"
                    id="credentialDateIssuedArea"
                    name="credentialDateIssuedArea"
                    autocomplete="off"
                    placeholder="MM-DD-YYYY"
                    type="date"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('credentialDateIssuedArea')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('credentialDateIssuedArea')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("credentialDateIssuedArea") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="credentialExpirationDateArea"
                    >Expiration Date</label
                  >
                  <input
                    formControlName="credentialExpirationDateArea"
                    id="credentialExpirationDateArea"
                    name="credentialExpirationDateArea"
                    autocomplete="off"
                    placeholder="MM-DD-YYYY"
                    type="date"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('credentialExpirationDateArea')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('credentialExpirationDateArea')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("credentialExpirationDateArea") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="currentChurchLocationArea"
                    >Current Church Location</label
                  >
                  <input
                    formControlName="currentChurchLocationArea"
                    id="currentChurchLocationArea"
                    name="currentChurchLocationArea"
                    autocomplete="off"
                    placeholder="Enter church location"
                    type="text"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('currentChurchLocationArea')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('currentChurchLocationArea')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("currentChurchLocationArea") }}
                  </div>
                </div>
              </div>

              <!-- Row 5: Current Church City/Town, State/Province, Country -->
              <div class="flex flex-row gap-6">
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="currentChurchCityArea"
                    >City/Town</label
                  >
                  <input
                    formControlName="currentChurchCityArea"
                    id="currentChurchCityArea"
                    name="currentChurchCityArea"
                    autocomplete="off"
                    placeholder="Enter city/town"
                    type="text"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('currentChurchCityArea')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('currentChurchCityArea')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("currentChurchCityArea") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="currentChurchStateArea"
                    >State/Province</label
                  >
                  <input
                    formControlName="currentChurchStateArea"
                    id="currentChurchStateArea"
                    name="currentChurchStateArea"
                    autocomplete="off"
                    placeholder="Enter state/province"
                    type="text"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('currentChurchStateArea')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('currentChurchStateArea')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("currentChurchStateArea") }}
                  </div>
                </div>
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="currentChurchCountryArea"
                    >Country</label
                  >
                  <input
                    formControlName="currentChurchCountryArea"
                    id="currentChurchCountryArea"
                    name="currentChurchCountryArea"
                    autocomplete="off"
                    placeholder="Enter country"
                    type="text"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('currentChurchCountryArea')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('currentChurchCountryArea')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("currentChurchCountryArea") }}
                  </div>
                </div>
              </div>

              <!-- Row 6: Current Pastor -->
              <div class="flex flex-row gap-6">
                <div class="flex flex-col flex-1">
                  <label
                    class="text-sm text-gray-700 mb-1"
                    for="currentPastorArea"
                    >Current Pastor</label
                  >
                  <input
                    formControlName="currentPastorArea"
                    id="currentPastorArea"
                    name="currentPastorArea"
                    autocomplete="off"
                    placeholder="Enter current pastor name"
                    type="text"
                    [class]="
                      'border rounded-md px-3 py-2 bg-gray-50 focus:outline-none focus:ring-2 ' +
                      (hasError('currentPastorArea')
                        ? 'border-red-500 focus:ring-red-400'
                        : 'border-gray-300 focus:ring-green-400')
                    "
                  />
                  <div
                    *ngIf="hasError('currentPastorArea')"
                    class="text-red-500 text-xs mt-1"
                  >
                    {{ getErrorMessage("currentPastorArea") }}
                  </div>
                </div>
                <div class="flex-1"></div>
                <div class="flex-1"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- References Section (for worker role only) -->
    <div
      class="bg-white rounded-xl mt-6 shadow-sm"
      *ngIf="currentUserRole === 'worker'"
    >
      <div class="pt-8 pb-12 px-8">
        <div class="w-full">
          <div
            class="text-base font-medium text-gray-800 border-b border-gray-100 pb-2 mb-6 flex items-center justify-between cursor-pointer"
            (click)="toggleAccordion('references')"
          >
            <span>References</span>
            <button
              type="button"
              class="flex items-center text-gray-400 hover:text-gray-600 transition-colors"
            >
              <svg
                class="w-5 h-5 transform transition-transform"
                [class.rotate-180]="!accordionState.references"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                ></path>
              </svg>
            </button>
          </div>
          <div
            *ngIf="accordionState.references"
            class="transition-all duration-300"
          >
            <div class="flex-1 flex flex-col gap-4">
              <!-- References Dynamic Section -->
              <div formArrayName="references">
                <div class="flex items-center justify-between mb-4">
                  <span class="text-sm font-medium text-gray-700"
                    >Reference Information</span
                  >
                  <button
                    type="button"
                    (click)="addReference()"
                    class="flex items-center gap-1 text-green-600 hover:text-green-700 transition-colors"
                  >
                    <svg
                      class="w-4 h-4"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 4v16m8-8H4"
                      ></path>
                    </svg>
                    <span class="text-sm">Add Reference</span>
                  </button>
                </div>

                <div
                  *ngFor="let reference of references.controls; let i = index"
                  [formGroupName]="i"
                  class="mb-4"
                >
                  <div class="flex items-center justify-between mb-3">
                    <span class="text-sm font-medium text-gray-700">
                      Reference {{ i + 1 }}
                    </span>
                    <button
                      type="button"
                      (click)="removeReference(i)"
                      class="text-red-600 hover:text-red-700 transition-colors"
                    >
                      <svg
                        class="w-4 h-4"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                        ></path>
                      </svg>
                    </button>
                  </div>

                  <!-- Row 1: Name, Phone, Email -->
                  <div class="flex flex-row gap-4 mb-3">
                    <div class="flex flex-col flex-1">
                      <label class="text-xs text-gray-600 mb-1">Name *</label>
                      <input
                        formControlName="referenceName"
                        type="text"
                        placeholder="Enter full name"
                        [class]="
                          'border rounded-md px-3 py-2 bg-white focus:outline-none focus:ring-2 text-sm ' +
                          (hasFormArrayError('references', i, 'referenceName')
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      />
                      <div
                        *ngIf="
                          hasFormArrayError('references', i, 'referenceName')
                        "
                        class="text-red-500 text-xs mt-1"
                      >
                        {{
                          getFormArrayErrorMessage(
                            "references",
                            i,
                            "referenceName"
                          )
                        }}
                      </div>
                    </div>
                    <div class="flex flex-col flex-1">
                      <label class="text-xs text-gray-600 mb-1">Phone *</label>
                      <input
                        formControlName="referencePhone"
                        type="tel"
                        placeholder="Enter phone number"
                        [class]="
                          'border rounded-md px-3 py-2 bg-white focus:outline-none focus:ring-2 text-sm ' +
                          (hasFormArrayError('references', i, 'referencePhone')
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      />
                      <div
                        *ngIf="
                          hasFormArrayError('references', i, 'referencePhone')
                        "
                        class="text-red-500 text-xs mt-1"
                      >
                        {{
                          getFormArrayErrorMessage(
                            "references",
                            i,
                            "referencePhone"
                          )
                        }}
                      </div>
                    </div>
                    <div class="flex flex-col flex-1">
                      <label class="text-xs text-gray-600 mb-1">Email *</label>
                      <input
                        formControlName="referenceEmail"
                        type="email"
                        placeholder="Enter email address"
                        [class]="
                          'border rounded-md px-3 py-2 bg-white focus:outline-none focus:ring-2 text-sm ' +
                          (hasFormArrayError('references', i, 'referenceEmail')
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      />
                      <div
                        *ngIf="
                          hasFormArrayError('references', i, 'referenceEmail')
                        "
                        class="text-red-500 text-xs mt-1"
                      >
                        {{
                          getFormArrayErrorMessage(
                            "references",
                            i,
                            "referenceEmail"
                          )
                        }}
                      </div>
                    </div>
                  </div>

                  <!-- Row 2: Address, City/Town, State/Province -->
                  <div class="flex flex-row gap-4 mb-3">
                    <div class="flex flex-col flex-1">
                      <label class="text-xs text-gray-600 mb-1"
                        >Address *</label
                      >
                      <input
                        formControlName="referenceAddress"
                        type="text"
                        placeholder="Enter street address"
                        [class]="
                          'border rounded-md px-3 py-2 bg-white focus:outline-none focus:ring-2 text-sm ' +
                          (hasFormArrayError(
                            'references',
                            i,
                            'referenceAddress'
                          )
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      />
                      <div
                        *ngIf="
                          hasFormArrayError('references', i, 'referenceAddress')
                        "
                        class="text-red-500 text-xs mt-1"
                      >
                        {{
                          getFormArrayErrorMessage(
                            "references",
                            i,
                            "referenceAddress"
                          )
                        }}
                      </div>
                    </div>
                    <div class="flex flex-col flex-1">
                      <label class="text-xs text-gray-600 mb-1"
                        >City/Town *</label
                      >
                      <input
                        formControlName="referenceCity"
                        type="text"
                        placeholder="Enter city/town"
                        [class]="
                          'border rounded-md px-3 py-2 bg-white focus:outline-none focus:ring-2 text-sm ' +
                          (hasFormArrayError('references', i, 'referenceCity')
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      />
                      <div
                        *ngIf="
                          hasFormArrayError('references', i, 'referenceCity')
                        "
                        class="text-red-500 text-xs mt-1"
                      >
                        {{
                          getFormArrayErrorMessage(
                            "references",
                            i,
                            "referenceCity"
                          )
                        }}
                      </div>
                    </div>
                    <div class="flex flex-col flex-1">
                      <label class="text-xs text-gray-600 mb-1"
                        >State/Province *</label
                      >
                      <input
                        formControlName="referenceState"
                        type="text"
                        placeholder="Enter state/province"
                        [class]="
                          'border rounded-md px-3 py-2 bg-white focus:outline-none focus:ring-2 text-sm ' +
                          (hasFormArrayError('references', i, 'referenceState')
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      />
                      <div
                        *ngIf="
                          hasFormArrayError('references', i, 'referenceState')
                        "
                        class="text-red-500 text-xs mt-1"
                      >
                        {{
                          getFormArrayErrorMessage(
                            "references",
                            i,
                            "referenceState"
                          )
                        }}
                      </div>
                    </div>
                  </div>

                  <!-- Row 3: Country, ZipCode, How do you know this person -->
                  <div class="flex flex-row gap-4">
                    <div class="flex flex-col flex-1">
                      <label class="text-xs text-gray-600 mb-1"
                        >Country *</label
                      >
                      <input
                        formControlName="referenceCountry"
                        type="text"
                        placeholder="Enter country"
                        [class]="
                          'border rounded-md px-3 py-2 bg-white focus:outline-none focus:ring-2 text-sm ' +
                          (hasFormArrayError(
                            'references',
                            i,
                            'referenceCountry'
                          )
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      />
                      <div
                        *ngIf="
                          hasFormArrayError('references', i, 'referenceCountry')
                        "
                        class="text-red-500 text-xs mt-1"
                      >
                        {{
                          getFormArrayErrorMessage(
                            "references",
                            i,
                            "referenceCountry"
                          )
                        }}
                      </div>
                    </div>
                    <div class="flex flex-col flex-1">
                      <label class="text-xs text-gray-600 mb-1"
                        >Zip Code *</label
                      >
                      <input
                        formControlName="referenceZipCode"
                        type="text"
                        placeholder="Enter zip code"
                        [class]="
                          'border rounded-md px-3 py-2 bg-white focus:outline-none focus:ring-2 text-sm ' +
                          (hasFormArrayError(
                            'references',
                            i,
                            'referenceZipCode'
                          )
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      />
                      <div
                        *ngIf="
                          hasFormArrayError('references', i, 'referenceZipCode')
                        "
                        class="text-red-500 text-xs mt-1"
                      >
                        {{
                          getFormArrayErrorMessage(
                            "references",
                            i,
                            "referenceZipCode"
                          )
                        }}
                      </div>
                    </div>
                    <div class="flex flex-col flex-1">
                      <label class="text-xs text-gray-600 mb-1"
                        >How do you know this person? *</label
                      >
                      <input
                        formControlName="relationshipToReference"
                        type="text"
                        placeholder="e.g., Former colleague, Pastor, etc."
                        [class]="
                          'border rounded-md px-3 py-2 bg-white focus:outline-none focus:ring-2 text-sm ' +
                          (hasFormArrayError(
                            'references',
                            i,
                            'relationshipToReference'
                          )
                            ? 'border-red-500 focus:ring-red-400'
                            : 'border-gray-300 focus:ring-green-400')
                        "
                      />
                      <div
                        *ngIf="
                          hasFormArrayError(
                            'references',
                            i,
                            'relationshipToReference'
                          )
                        "
                        class="text-red-500 text-xs mt-1"
                      >
                        {{
                          getFormArrayErrorMessage(
                            "references",
                            i,
                            "relationshipToReference"
                          )
                        }}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Legal Questions Section -->
    <div class="bg-white rounded-xl mt-6 shadow-sm">
      <div class="pt-8 pb-12 px-8">
        <div class="w-full">
          <div
            class="text-base font-medium text-gray-800 border-b border-gray-100 pb-2 mb-6 flex items-center justify-between cursor-pointer"
            (click)="toggleAccordion('legalQuestions')"
          >
            <span>Legal Questions</span>
            <button
              type="button"
              class="flex items-center text-gray-400 hover:text-gray-600 transition-colors"
            >
              <svg
                class="w-5 h-5 transform transition-transform"
                [class.rotate-180]="!accordionState.legalQuestions"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                ></path>
              </svg>
            </button>
          </div>
          <div
            *ngIf="accordionState.legalQuestions"
            class="transition-all duration-300"
          >
            <div class="flex-1 flex flex-col gap-6">
              <!-- Question 1 -->
              <div class="flex flex-col">
                <label class="text-sm text-gray-700 mb-3"
                  >Have you ever been convicted of, pled guilty to, or pled no
                  contest to a crime or misdemeanor? *</label
                >
                <div class="flex gap-6">
                  <label class="flex items-center text-sm text-gray-600">
                    <input
                      type="radio"
                      formControlName="beenConvicted"
                      value="Yes"
                      class="mr-2 w-4 h-4 text-green-600 bg-gray-100 border-gray-300 focus:ring-green-500 focus:ring-2 rounded-full"
                    />
                    Yes
                  </label>
                  <label class="flex items-center text-sm text-gray-600">
                    <input
                      type="radio"
                      formControlName="beenConvicted"
                      value="No"
                      class="mr-2 w-4 h-4 text-green-600 bg-gray-100 border-gray-300 focus:ring-green-500 focus:ring-2 rounded-full"
                    />
                    No
                  </label>
                </div>
                <div
                  *ngIf="hasError('beenConvicted')"
                  class="text-red-500 text-xs mt-1"
                >
                  {{ getErrorMessage("beenConvicted") }}
                </div>
              </div>

              <!-- Question 2 -->
              <div class="flex flex-col">
                <label class="text-sm text-gray-700 mb-3"
                  >Have you ever been the subject of a sexual misconduct or
                  child abuse investigation? *</label
                >
                <div class="flex gap-6">
                  <label class="flex items-center text-sm text-gray-600">
                    <input
                      type="radio"
                      formControlName="hasBeenInvestigatedForMisconductOrAbuse"
                      value="Yes"
                      class="mr-2 w-4 h-4 text-green-600 bg-gray-100 border-gray-300 focus:ring-green-500 focus:ring-2 rounded-full"
                    />
                    Yes
                  </label>
                  <label class="flex items-center text-sm text-gray-600">
                    <input
                      type="radio"
                      formControlName="hasBeenInvestigatedForMisconductOrAbuse"
                      value="No"
                      class="mr-2 w-4 h-4 text-green-600 bg-gray-100 border-gray-300 focus:ring-green-500 focus:ring-2 rounded-full"
                    />
                    No
                  </label>
                </div>
                <div
                  *ngIf="hasError('hasBeenInvestigatedForMisconductOrAbuse')"
                  class="text-red-500 text-xs mt-1"
                >
                  {{
                    getErrorMessage("hasBeenInvestigatedForMisconductOrAbuse")
                  }}
                </div>
              </div>

              <!-- Question 3 -->
              <div class="flex flex-col">
                <label class="text-sm text-gray-700 mb-3"
                  >Is there any circumstance in your background that could call
                  into question your integrity or being entrusted with the
                  supervision of children? *</label
                >
                <div class="flex gap-6">
                  <label class="flex items-center text-sm text-gray-600">
                    <input
                      type="radio"
                      formControlName="hasQuestionableBackground"
                      value="Yes"
                      class="mr-2 w-4 h-4 text-green-600 bg-gray-100 border-gray-300 focus:ring-green-500 focus:ring-2 rounded-full"
                    />
                    Yes
                  </label>
                  <label class="flex items-center text-sm text-gray-600">
                    <input
                      type="radio"
                      formControlName="hasQuestionableBackground"
                      value="No"
                      class="mr-2 w-4 h-4 text-green-600 bg-gray-100 border-gray-300 focus:ring-green-500 focus:ring-2 rounded-full"
                    />
                    No
                  </label>
                </div>
                <div
                  *ngIf="hasError('hasQuestionableBackground')"
                  class="text-red-500 text-xs mt-1"
                >
                  {{ getErrorMessage("hasQuestionableBackground") }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Upload Documents Section -->
    <div class="bg-white rounded-xl mt-6 shadow-sm">
      <div class="pt-8 pb-12 px-8">
        <div class="w-full">
          <div
            class="text-base font-medium text-gray-800 border-b border-gray-100 pb-2 mb-6 flex items-center justify-between cursor-pointer"
            (click)="toggleAccordion('uploadDocuments')"
          >
            <span>Upload Documents</span>
            <button
              type="button"
              class="flex items-center text-gray-400 hover:text-gray-600 transition-colors"
            >
              <svg
                class="w-5 h-5 transform transition-transform"
                [class.rotate-180]="!accordionState.uploadDocuments"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                ></path>
              </svg>
            </button>
          </div>
          <div
            *ngIf="accordionState.uploadDocuments"
            class="transition-all duration-300"
          >
            <!-- Upload Documents Content -->
            <div class="space-y-6">
              <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                  Upload Documents
                </label>

                <!-- Drag and Drop Zone -->
                <div
                  class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-gray-400 transition-colors"
                  [class.border-green-500]="isUploadingDocuments"
                  (dragover)="onDragOver($event)"
                  (dragleave)="onDragLeave($event)"
                  (drop)="onDrop($event)"
                >
                  <input
                    type="file"
                    multiple
                    (change)="onDocumentSelect($event)"
                    class="hidden"
                    #fileInput
                    accept=".pdf,.doc,.docx,.txt,.xls,.xlsx"
                  />

                  <div
                    class="flex flex-col items-center"
                    *ngIf="!isUploadingDocuments"
                  >
                    <svg
                      class="w-12 h-12 text-gray-400 mb-4"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"
                      />
                    </svg>
                    <button
                      type="button"
                      (click)="fileInput.click()"
                      class="text-green-600 hover:text-green-700 font-medium text-lg mb-2"
                    >
                      Choose files or drag and drop
                    </button>
                    <p class="text-sm text-gray-500">
                      PDF, DOC, DOCX, TXT, XLS, XLSX up to 10MB each
                    </p>
                  </div>

                  <!-- Upload Progress -->
                  <div
                    class="flex flex-col items-center"
                    *ngIf="isUploadingDocuments"
                  >
                    <div
                      class="animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mb-4"
                    ></div>
                    <p class="text-green-600 font-medium">
                      Uploading documents...
                    </p>
                  </div>
                </div>
              </div>

              <!-- Enhanced File List -->
              <div *ngIf="uploadedFiles.length > 0" class="space-y-3">
                <h4 class="text-sm font-medium text-gray-700">
                  Uploaded Files
                </h4>
                <div class="space-y-2">
                  <div
                    *ngFor="let file of uploadedFiles; let i = index"
                    class="flex items-center justify-between p-3 bg-gray-50 rounded-lg border"
                  >
                    <div class="flex items-center space-x-3">
                      <!-- File Type Icon -->
                      <div class="flex-shrink-0">
                        <svg
                          *ngIf="getFileType(file.name) === 'pdf'"
                          class="w-8 h-8 text-red-500"
                          fill="currentColor"
                          viewBox="0 0 20 20"
                        >
                          <path
                            d="M4 18h12V6l-4-4H4v16zM9 13v-2h2v2H9zm0-3V8h2v2H9z"
                          />
                        </svg>
                        <svg
                          *ngIf="getFileType(file.name) === 'word'"
                          class="w-8 h-8 text-blue-500"
                          fill="currentColor"
                          viewBox="0 0 20 20"
                        >
                          <path
                            d="M4 18h12V6l-4-4H4v16zM9 13v-2h2v2H9zm0-3V8h2v2H9z"
                          />
                        </svg>
                        <svg
                          *ngIf="getFileType(file.name) === 'excel'"
                          class="w-8 h-8 text-green-500"
                          fill="currentColor"
                          viewBox="0 0 20 20"
                        >
                          <path
                            d="M4 18h12V6l-4-4H4v16zM9 13v-2h2v2H9zm0-3V8h2v2H9z"
                          />
                        </svg>
                        <svg
                          *ngIf="getFileType(file.name) === 'file'"
                          class="w-8 h-8 text-gray-500"
                          fill="currentColor"
                          viewBox="0 0 20 20"
                        >
                          <path
                            d="M4 18h12V6l-4-4H4v16zM9 13v-2h2v2H9zm0-3V8h2v2H9z"
                          />
                        </svg>
                      </div>

                      <!-- File Info -->
                      <div class="flex-1 min-w-0">
                        <p class="text-sm font-medium text-gray-900 truncate">
                          {{ file.name }}
                        </p>
                        <p class="text-xs text-gray-500">
                          {{ formatFileSize(file.size) }}
                        </p>
                      </div>
                    </div>

                    <!-- Remove Button -->
                    <button
                      type="button"
                      (click)="removeFile(i)"
                      class="text-red-500 hover:text-red-700 transition-colors"
                    >
                      <svg
                        class="w-5 h-5"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M6 18L18 6M6 6l12 12"
                        ></path>
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Submit Button -->
    <div class="flex justify-end gap-4 pt-6 pb-12">
      <button
        type="button"
        (click)="goBack()"
        class="px-8 py-3 rounded-md font-medium border border-green-600 text-green-600 hover:bg-green-50 transition-colors"
      >
        Cancel
      </button>
      <button
        type="submit"
        [disabled]="!isEditMode && !isFormValid()"
        [class]="
          'px-8 py-3 rounded-md font-medium transition-colors ' +
          (isEditMode || isFormValid()
            ? 'bg-green-600 hover:bg-green-700 text-white'
            : 'bg-gray-300 text-gray-500 cursor-not-allowed')
        "
      >
        {{ isEditMode ? "Update Profile" : "Submit" }}
      </button>
    </div>
  </form>
</div>

<!-- Confirmation Modal -->
<app-confirm-prompt
  *ngIf="showModal"
  [title]="promptConfig?.title || ''"
  [text]="promptConfig?.text || ''"
  [imageUrl]="promptConfig?.imageUrl || null"
  [yesButtonText]="promptConfig?.yesButtonText || ''"
  [noButtonText]="promptConfig?.noButtonText || ''"
  (confirmed)="onModalConfirm($event)"
  (closed)="onModalClose()"
></app-confirm-prompt>
