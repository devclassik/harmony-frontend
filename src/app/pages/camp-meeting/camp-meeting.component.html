<!-- Loading Overlay -->
<app-loading-overlay
  [isVisible]="isLoading || isCreating || isDeleting"
  [title]="
    isDeleting
      ? 'Deleting Camp Meeting...'
      : isCreating
      ? isEditMode
        ? 'Updating Camp Meeting...'
        : 'Creating Camp Meeting...'
      : 'Loading Camp Meetings...'
  "
  [message]="
    isDeleting
      ? 'Please wait while we delete the camp meeting.'
      : isCreating
      ? isEditMode
        ? 'Please wait while we update the camp meeting.'
        : 'Please wait while we create the camp meeting.'
      : 'Please wait while we fetch camp meeting data.'
  "
></app-loading-overlay>

<div class="min-h-screen p-4">
  <div class="mx-auto max-w-full">
    <!-- Calendar Container -->
    <div class="rounded-lg">
      <app-table
        [tableTitle]="'Camp Meeting Calendar'"
        [currentView]="'calendar'"
        [showSearch]="false"
        [showFilter]="false"
        [showStatusTab]="false"
        [showPagination]="false"
        [showViewAll]="false"
        [showSelectCheckbox]="false"
        [showButton]="shouldShowCreateButton"
        showButtonText="Create Request"
        showButtonIcon="assets/svg/add.svg"
        showButtonStyle="bg-gradient-to-r from-[#12C16F] to-[#0A8754] hover:from-[#0A8754] hover:to-[#12C16F]"
        [tableData]="[]"
        [calendarEvents]="campMeetingCalendarEvents"
        [customEventClick]="handleCalendarEventClick"
        (menuAction)="onTableMenuAction($event)"
        (showButtonActionClick)="onCreateButtonClick()"
      ></app-table>
    </div>
  </div>

  <!-- Camp Meeting Details using Leave Details Component -->
  <app-leave-details
    [view]="showSlideIn || showCreateSlideOut"
    [leaveData]="
      showCreateSlideOut
        ? isEditMode
          ? selectedMeetingData
          : {}
        : getMeetingAsLeaveData()
    "
    [title]="
      showCreateSlideOut
        ? isEditMode
          ? 'Edit Pre Campmeeting'
          : 'Create Pre Campmeeting'
        : 'Pre Campmeeting Information'
    "
    [leaveType]="'Pre Campmeeting'"
    [totalLeaveDays]="0"
    [showRequestType]="false"
    [showDuration]="false"
    [showLocation]="false"
    [showEndDate]="false"
    [showSubstitution]="false"
    [showAttendees]="true"
    [isCampMeeting]="true"
    [mode]="showCreateSlideOut ? 'create' : 'view'"
    [isEditMode]="isEditMode"
    [canEdit]="shouldShowCreateButton"
    [selectedMeetingData]="selectedMeetingData"
    (close)="showCreateSlideOut ? onCreateSlideOutClose() : onSlideInClose()"
    (submit)="showCreateSlideOut ? onCreateFormSubmitted($event) : null"
    (cancel)="showCreateSlideOut ? onCreateSlideOutClose() : null"
    (edit)="onEditButtonClick($event)"
    (delete)="onDeleteButtonClick($event)"
  ></app-leave-details>

  <!-- Delete Confirmation Modal -->
  <app-confirm-prompt
    *ngIf="showDeleteConfirmation"
    title="Delete Camp Meeting"
    text="Are you sure you want to delete this camp meeting? This action cannot be undone."
    yesButtonText="Delete"
    noButtonText="Cancel"
    yesButtonColor="red"
    (confirmed)="onDeleteConfirmed($event)"
    (closed)="showDeleteConfirmation = false"
  ></app-confirm-prompt>
</div>
